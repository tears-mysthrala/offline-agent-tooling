# ================================
# AGENT TOOLS: MVP smoke tests
# Each command below exercises a newly added local tool.
# These should be idempotent and safe to run multiple times.
# ================================

# FS Tool: write a temp file
tools\ps\fs.ps1 -op write -path d:\tooling\tmp.txt -content "hola"

# FS Tool: read it back
tools\ps\fs.ps1 -op read -path d:\tooling\tmp.txt

# Search Tool: grep for TODO across repo
tools\ps\search.ps1 -op grep -root d:\tooling -pattern "TODO"

# Process Runner: run a simple PowerShell output
tools\ps\process.ps1 -op run -cmd "Write-Output 'runner ok'"

# Log Tool: write a JSON log line
tools\ps\log.ps1 -op log -level info -msg "init via wrapper"

# Adapter: list available PowerShell tools
tools\ps\adapter.ps1 -op list

# HTTP Tool (Python, offline fixture) - Uncomment if Python is installed and on PATH
# HTTP Tool (Python, offline fixture) - try run if Python is available
tools\ps\http-test.ps1

# KV store tests (SQLite)
python -c "import runpy,sys; sys.argv=['kv.py','--op','set','--ns','test','--key','k1','--value','v1']; runpy.run_path('tools/py/kv.py', run_name='__main__')"
python -c "import runpy,sys; sys.argv=['kv.py','--op','get','--ns','test','--key','k1']; runpy.run_path('tools/py/kv.py', run_name='__main__')"
python -c "import runpy,sys; sys.argv=['kv.py','--op','keys','--ns','test']; runpy.run_path('tools/py/kv.py', run_name='__main__')"
python -c "import runpy,sys; sys.argv=['kv.py','--op','del','--ns','test','--key','k1']; runpy.run_path('tools/py/kv.py', run_name='__main__')"
python -c "import runpy,sys; sys.argv=['kv.py','--op','get','--ns','test','--key','k1']; runpy.run_path('tools/py/kv.py', run_name='__main__')"

# -----------------
# FS extended ops tests
# -----------------

# Make test directory
tools\ps\fs.ps1 -op mkdir -path d:\tooling\testdir

# Write JSON into testdir
tools\ps\fs.ps1 -op write-json -path d:\tooling\testdir\data.json -content "{ \"a\": 1, \"b\": \"x\" }"

# Read JSON back
tools\ps\fs.ps1 -op read-json -path d:\tooling\testdir\data.json

# Append to tmp.txt
tools\ps\fs.ps1 -op append -path d:\tooling\tmp.txt -content "mundo"

# Read lines from tmp.txt
tools\ps\fs.ps1 -op read-lines -path d:\tooling\tmp.txt

# Checksum tmp.txt
tools\ps\fs.ps1 -op checksum -path d:\tooling\tmp.txt

# Glob for txt files
tools\ps\fs.ps1 -op glob -path d:\tooling -pattern "*.txt" -recursive

# Search with include (only txt files)
tools\ps\search.ps1 -op grep -root d:\tooling -pattern "TODO" -include "*.txt" -recursive

# Search excluding scripts folder (should not return commands.txt)
tools\ps\search.ps1 -op grep -root d:\tooling -pattern "TODO" -exclude "commands.txt" -recursive

# Copy tmp.txt into testdir
tools\ps\fs.ps1 -op copy -path d:\tooling\tmp.txt -dest d:\tooling\testdir\tmp_copy.txt

# Move the copy
tools\ps\fs.ps1 -op move -path d:\tooling\testdir\tmp_copy.txt -dest d:\tooling\testdir\tmp_moved.txt

# Read moved file
tools\ps\fs.ps1 -op read-lines -path d:\tooling\testdir\tmp_moved.txt

# Delete the testdir (confirm)
tools\ps\fs.ps1 -op delete -path d:\tooling\testdir -confirm
